<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>q2_feature_table : summarize</title>
    <link rel="stylesheet" href="./q2templateassets/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="./q2templateassets/css/normalize.css"/>
    <link rel="stylesheet" href="./q2templateassets/css/base-template.css"/>
    <script src="./q2templateassets/js/jquery-3.2.0.min.js" charset="utf-8"></script>
    <script src="./q2templateassets/js/bootstrap.min.js" charset="utf-8"></script>
    
<script src="js/vega.min.js"></script>
<script src="js/vega-embed.min.js"></script>
<link rel="stylesheet" type="text/css" href="css/spinkit.css" /> 
  </head>
  <body>
    <div class="container-fluid">
      <div id="q2templatesheader" class="row">
        <div class="col-lg-12">
          <a href="http://qiime2.org/">
            <img src="./q2templateassets/img/qiime2-rect-200.png"
            alt="QIIME 2">
          </a>
        </div>
      </div>
        

  <div class="row">
    <div class="col-lg-12">
      <ul class="nav nav-tabs">
        
          <li class="">
            <a href="index.html">
              Overview
            </a>
          </li>
        
          <li class="active">
            <a href="sample-frequency-detail.html">
              Interactive Sample Detail
            </a>
          </li>
        
          <li class="">
            <a href="feature-frequency-detail.html">
              Feature Detail
            </a>
          </li>
        
      </ul>
    </div>
  </div>
  <div class="row">
    <div class="col-lg-12">
      


<div class="row">
  <div class="col-lg-4">
    <div class="row">
      <div class="col-lg-12" id="sampling-depth-slider">
        <label> Sampling Depth &nbsp; </label> <br>
        <input id="range-slider" type="range" min="0" max="4559.0" value="0" class="slider" oninput="sliderHelperFunction(this.value);"> <br>
        <input id="text-box" class="form-control" type="number" value="0" min="0" oninput="textBoxHelperFunction(this.value);"/>
        <br>
        (zero implies no even sampling)
        <div class="row">
          <div class="col-lg-12" id="text-field"></div>
        </div>
      </div>
    </div>
  </div>
</div>



<div class="row">
  <div class="col-lg-8">
    <table id="feature-table" class="table table-striped">
      <thead>
        <tr>
          <th scope="col">Sample ID</th>
          <th scope="col">Feature Count</th>
        </tr>
      </thead>
      <tbody id="table-body"></tbody>
    </table>
  </div>
</div>

<script id="table-data" type="application/json">
{"ERR4094164":4559.0,"ERR4094199":3855.0,"ERR4094166":3730.0,"ERR4094145":3678.0,"ERR4094119":3411.0,"ERR4094131":3332.0,"ERR4094153":3177.0,"ERR4094117":3011.0,"ERR4094176":2599.0,"ERR4094134":2567.0,"ERR4094207":2534.0,"ERR4094189":2462.0,"ERR4094211":2428.0,"ERR4094158":2335.0,"ERR4094159":2302.0,"ERR4094155":2279.0,"ERR4094061":2277.0,"ERR4094161":2174.0,"ERR4094062":2168.0,"ERR4094156":2133.0,"ERR4094203":2124.0,"ERR4094148":2117.0,"ERR4094183":2086.0,"ERR4094059":2075.0,"ERR4094027":2045.0,"ERR4094215":1986.0,"ERR4094132":1974.0,"ERR4094025":1964.0,"ERR4094206":1959.0,"ERR4094175":1941.0,"ERR4094150":1916.0,"ERR4094179":1909.0,"ERR4094137":1892.0,"ERR4094154":1872.0,"ERR4094107":1858.0,"ERR4094032":1848.0,"ERR4094133":1837.0,"ERR4094208":1800.0,"ERR4094143":1669.0,"ERR4094201":1657.0,"ERR4094054":1631.0,"ERR4094118":1619.0,"ERR4094139":1601.0,"ERR4094205":1595.0,"ERR4094204":1590.0,"ERR4094128":1560.0,"ERR4094151":1551.0,"ERR4094182":1545.0,"ERR4094157":1527.0,"ERR4094064":1521.0,"ERR4094135":1514.0,"ERR4094200":1485.0,"ERR4094136":1485.0,"ERR4094140":1447.0,"ERR4094210":1432.0,"ERR4094075":1409.0,"ERR4094170":1377.0,"ERR4094036":1363.0,"ERR4094024":1332.0,"ERR4094035":1285.0,"ERR4094109":1283.0,"ERR4094167":1281.0,"ERR4094129":1276.0,"ERR4094039":1273.0,"ERR4094100":1272.0,"ERR4094124":1216.0,"ERR4094084":1213.0,"ERR4094074":1197.0,"ERR4094033":1193.0,"ERR4094029":1162.0,"ERR4094169":1153.0,"ERR4094214":1144.0,"ERR4094198":1105.0,"ERR4094212":1104.0,"ERR4094162":1097.0,"ERR4094213":1081.0,"ERR4094130":1074.0,"ERR4094160":1029.0,"ERR4094202":1028.0,"ERR4094177":1026.0,"ERR4094180":1019.0,"ERR4094044":1008.0,"ERR4094152":1004.0,"ERR4094163":994.0,"ERR4094060":993.0,"ERR4094193":988.0,"ERR4094121":986.0,"ERR4094120":984.0,"ERR4094034":982.0,"ERR4094181":979.0,"ERR4094174":952.0,"ERR4094031":944.0,"ERR4094165":942.0,"ERR4094186":924.0,"ERR4094146":924.0,"ERR4094195":889.0,"ERR4094127":871.0,"ERR4094043":857.0,"ERR4094147":852.0,"ERR4094168":851.0,"ERR4094149":840.0,"ERR4094138":839.0,"ERR4094101":827.0,"ERR4094142":820.0,"ERR4094194":814.0,"ERR4094187":806.0,"ERR4094037":805.0,"ERR4094197":802.0,"ERR4094216":800.0,"ERR4094185":799.0,"ERR4094126":789.0,"ERR4094192":777.0,"ERR4094068":772.0,"ERR4094053":767.0,"ERR4094188":764.0,"ERR4094209":764.0,"ERR4094108":758.0,"ERR4094178":750.0,"ERR4094067":742.0,"ERR4094055":734.0,"ERR4094123":729.0,"ERR4094065":727.0,"ERR4094112":719.0,"ERR4094171":713.0,"ERR4094217":704.0,"ERR4094058":683.0,"ERR4094078":672.0,"ERR4094116":639.0,"ERR4094196":637.0,"ERR4094048":634.0,"ERR4094141":616.0,"ERR4094122":594.0,"ERR4094173":592.0,"ERR4094172":583.0,"ERR4094191":581.0,"ERR4094052":564.0,"ERR4094056":557.0,"ERR4094105":555.0,"ERR4094038":553.0,"ERR4094184":553.0,"ERR4094057":530.0,"ERR4094115":530.0,"ERR4094125":528.0,"ERR4094047":527.0,"ERR4094218":512.0,"ERR4094049":508.0,"ERR4094050":506.0,"ERR4094087":496.0,"ERR4094083":483.0,"ERR4094030":471.0,"ERR4094077":469.0,"ERR4094076":466.0,"ERR4094104":461.0,"ERR4094092":445.0,"ERR4094114":440.0,"ERR4094113":440.0,"ERR4094106":437.0,"ERR4094102":429.0,"ERR4094190":426.0,"ERR4094066":425.0,"ERR4094103":423.0,"ERR4094144":414.0,"ERR4094096":413.0,"ERR4094028":391.0,"ERR4094070":381.0,"ERR4094080":345.0,"ERR4094051":341.0,"ERR4094095":337.0,"ERR4094099":332.0,"ERR4094079":328.0,"ERR4094071":317.0,"ERR4094069":316.0,"ERR4094041":313.0,"ERR4094094":303.0,"ERR4094046":301.0,"ERR4094098":295.0,"ERR4094081":289.0,"ERR4094042":285.0,"ERR4094040":285.0,"ERR4094110":283.0,"ERR4094091":281.0,"ERR4094086":268.0,"ERR4094090":260.0,"ERR4094097":242.0,"ERR4094111":238.0,"ERR4094082":212.0,"ERR4094093":211.0,"ERR4094085":207.0,"ERR4094045":206.0,"ERR4094073":202.0,"ERR4094072":161.0,"ERR4094089":158.0,"ERR4094063":151.0,"ERR4094026":99.0,"ERR4094088":85.0}
</script>

<script type="text/javascript">
  var totalFrequencies = 215135;
  var sampleCount = 195;
  var defaultDescription = "Retained " + (totalFrequencies.toLocaleString('en'))
                                       + " (100.00%) features in "
                                       + sampleCount + " (100.00%) samples at the specifed sampling depth.";


  var textField = document.getElementById('text-field');
  var tableBody = document.getElementById("table-body");
  var table = document.getElementById("feature-table");

  // when the viz loads the default description is displayed
  textField.innerHTML = defaultDescription;

  var sampleFrequency = JSON.parse(document.getElementById("table-data").innerHTML);
  // get object keys and store them in an ascending order based on the key value
  // this order is used to create the table rows
  sortedSampleIDs = Object.keys(sampleFrequency).sort(function(a, b) {
    var temp = sampleFrequency[a] - sampleFrequency[b];
    // if two samples have the same number of features then we
    // determine the order using the sample ID alphabetical order
    if (temp == 0){
      return b.localeCompare(a);
    }

  return temp;
  });

  sortedSampleIDs.forEach(function(element) {
    var row = tableBody.insertRow(0);
    var cell1 = row.insertCell(0);
    var cell2 = row.insertCell(1);
    cell1.innerHTML = element;
    cell2.innerHTML = sampleFrequency[element];

  });


  function updateTableandText(val) {
    var retainedSampleCount = 0;

    // start the counter at 1 to ignore the header row
    for (var i = 1; row = table.rows[i]; i++) {

      if (Number(row.cells[1].innerHTML) < val) {
        row.className = "danger";
      } else {
        row.className = "";
        retainedSampleCount += 1;
      }
    }
    if (val == 0){

    textField.innerHTML = defaultDescription;

    }
    else{
      var retainedFeatureCount = retainedSampleCount * val;
      textField.innerHTML = "Retained " + retainedFeatureCount.toLocaleString('en')
                                        + " (" + (retainedFeatureCount/totalFrequencies*100).toFixed(2) + "%) features in "
                                        + retainedSampleCount + " (" + (retainedSampleCount/sampleCount*100).toFixed(2)
                                        +  "%) samples at the specifed sampling depth.";
    }

  }


  function updateSliderVal(val) {
    var slider = document.getElementById("range-slider");
    slider.value = val;
    slider.dispatchEvent(new Event("change"));
    slider.dispatchEvent(new Event("input"));
  }


  function updateBoxVal(val) {
    var num = document.getElementById("text-box");
    num.value = val;
  }


  function sliderHelperFunction(val){
    updateBoxVal(val);
    updateTableandText(val);

  }


  function textBoxHelperFunction(val){
    val = parseInt(val);
    if (val !== val) {
      val = 0;
    }

    // make sure the value in the textbox cannot exceed the max count
    if (val > 4559.0){
      var num = document.getElementById("text-box");
      num.value = 4559.0;
    }
    updateSliderVal(val);
  }
</script>


    </div>
  </div>


    </div>
    <script type="text/javascript">
      if (window.frameElement) {
          document.getElementById('q2templatesheader').remove();
      }
    </script>
    

  </body>
</html>